[연구 일지] 2026-01-13

1. 주요 내용
빌 윌리엄스(Bill Williams)의 '엘리게이터(Alligator)' 지표 정밀 구현 및 분석 모듈(Fundamental/Technical)의 자료형 안정성(Type Safety) 강화.

2. 진행 요약
단순 이동평균선(MA)만으로는 횡보장과 추세장을 구분하기 어렵다는 한계를 극복하기 위해, 프랙탈 전략의 핵심 필터인 '엘리게이터' 지표를 추가함. 트레이딩뷰(TradingView) 등 전문 툴과 동일한 수치를 산출하기 위해 중간가(Median Price), SMMA(평활이동평균), 미래 오프셋(Shift) 로직을 적용하여 정교하게 구현함. 또한, CLI 전체 스캔 모드 구동 시 발생하던 API 데이터의 자료형 불일치(문자열 vs 숫자) 오류들을 전수 조사하여 수정함으로써 시스템 안정성을 대폭 향상시킴.

3. 주요 수정 및 개발 내용
기술적 지표 고도화 (Alligator Indicator):
단순 종가(Close) 기준이 아닌 **중간가((High+Low)/2)**를 기준으로 설정.
계산식에 **SMMA(Smoothed Moving Average)**를 적용하기 위해 pandas_ta.rma 활용.
Jaw(13,8), Teeth(8,5), Lips(5,3) 각 선을 미래 시점으로 이동(Shift)시키는 선행 지표 로직 구현.
chart_view.py에 해당 지표 렌더링 및 범례(Legend) 추가.

모듈 안정성 강화 (Robustness):
fundamental.py: yfinance API가 숫자 대신 'N/A'나 문자열을 반환할 경우 프로그램이 멈추는 현상을 방지하기 위해 safe_float 변환 함수 도입.
technical.py: CLI(소문자 컬럼)와 GUI(대문자 컬럼) 간의 데이터 호환성 문제를 해결하기 위해, 대소문자 구분 없이 컬럼을 안전하게 탐색하는 get_col 헬퍼 함수 구현.

4. 시행 착오 및 오류 해결
[지표 계산 시 자료형 오류]
증상: AttributeError: 'str' object has no attribute 'shift' 발생.
원인: CLI 모드에서 컬럼명을 소문자('high')로 넘길 때, 데이터프레임의 컬럼명이 아닌 문자열 자체에 shift 함수를 적용하려 하여 발생.
해결: get_col 함수를 통해 데이터프레임 내 실제 존재하는 컬럼명(Series)을 동적으로 찾아와 연산하도록 수정.

[펀더멘털 분석 비교 연산 오류]
증상: TypeError: '>' not supported between instances of 'str' and 'int'.
원인: yfinance가 PER, EPS 등의 데이터를 가끔 문자열(String) 형태로 반환하여 숫자 0과 비교 불가능.
해결: 모든 재무 데이터 파싱 로직에 safe_float 래퍼를 씌워, 비정상 데이터 유입 시 강제로 0.0으로 변환 처리.

[엘리게이터 구현 로직 수정]
시행착오: 초기에는 단순 EMA로 구현했으나, 오리지널 전략과 오차가 발생.
해결: 빌 윌리엄스 공식에 맞춰 Median Price -> SMMA(Wilder's Smoothing) -> Shift 순서의 정석 로직으로 전면 재작성.

5. 다음 목표
보조지표 설정 화면(IndicatorView) 구현: 사용자가 GUI 상에서 이동평균선, 엘리게이터, 볼린저 밴드 등의 On/Off 및 파라미터를 실시간으로 제어하는 패널 개발.
설정 화면(SettingsView) 구현: API 키 관리, 테마 설정 등 시스템 환경 설정 UI 구축.
자동 매매 로직 연동: CLI의 전체 스캔 및 자동 매매 로직을 GUI 버튼 트리거에 연결.